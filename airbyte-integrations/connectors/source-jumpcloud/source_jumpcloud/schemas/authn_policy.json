{
  "description": "This represents an authentication policy.  See the details of each field for valid values and restrictions.\n\nConditions may be added to an authentication policy using the following conditional language:\n\n```\n<conditions> ::= <expression>\n<expression> ::= <ipAddressIn> | <deviceManaged> | <locationIn> | <notExpression> | <allExpression> | <anyExpression>\n<ipAddressIn> ::= { \"ipAddressIn\": [ <objectId>, ... ] }\n<deviceManaged> ::= { \"deviceManaged\": <boolean> }\n<locationIn> ::= { \"locationIn\": { \"countries\": [ <iso_3166_country_code>, ... ] } }\n<notExpression> ::= { \"not\": <expression> }\n<allExpression> ::= { \"all\": [ <expression>, ... ] }\n<anyExpression> ::= { \"any\": [ <expression>, ... ] }\n```\n\nFor example, to add a condition that applies to IP address in a given list the following condition can be added:\n\n`{\"ipAddressIn\": [ <ip_list_object_id> ]}`\n\nIf you would rather exclude IP addresses in the given lists, the following condition could be added:\n\n`{\n  \"not\": {\n    \"ipAddressIn\": [ <ip_list_object_id_1>, <ip_list_object_id_2> ]\n  }\n}`\n\nYou may also include more than one condition and choose whether \"all\" or \"any\" of them must be met for the policy to apply.\n\n`{\n  \"all\": [\n    {\n      \"ipAddressIn\": [ <ip_list_object_id>, ... ]\n    },\n    {\n      \"deviceManaged\": true\n    },\n    {\n      \"locationIn\": {\n        countries: [ <iso_3166_country_code>, ... ]\n      }\n    }\n  ]\n}`",
  "properties": {
    "conditions": {
      "type": "object"
    },
    "description": {
      "type": "string"
    },
    "disabled": {
      "type": "boolean"
    },
    "effect": {
      "properties": {
        "action": {
          "enum": [
            "allow",
            "deny",
            "unknown"
          ],
          "type": "string"
        },
        "obligations": {
          "properties": {
            "mfa": {
              "properties": {
                "required": {
                  "type": "boolean"
                }
              },
              "type": "object"
            }
          },
          "title": "AuthnPolicyObligations",
          "type": "object"
          }
      },
      "required": [
        "action"
      ],
      "title": "AuthnPolicyEffect",
      "type": "object",
      "x-examples": {
        "example-allow": {
          "action": "allow"
        },
        "example-allow-with-mfa": {
          "action": "allow",
          "obligations": {
            "mfa": {
              "required": true
            }
          }
        },
        "example-deny": {
          "action": "deny"
        }
      }
    },
    "id": {
      "type": "string"
    },
    "name": {
      "type": "string"
    },
    "targets": {
      "properties": {
        "resources": {
          "items": {
              "properties": {
                "id": {
                  "description": "Object ID of the resource target. If undefined, then all resources of the given type are targeted.",
                  "type": "string"
                },
                "type": {
                  "enum": [
                    "user_portal",
                    "application",
                    "ldap"
                  ],
                  "type": "string"
                }
              },
              "required": [
                "type"
              ],
              "title": "AuthnPolicyResourceTarget",
              "type": "object"
          },
          "type": "array"
        },
        "userAttributes": {
            "description": "User attribute targets are currently only supported for LDAP policies.",
            "properties": {
              "exclusions": {
                "items": {
                    "properties": {
                    "field": {
                      "description": "The only field that is currently supported is ldap_binding_user",
                      "type": "string"
                    },
                    "operator": {
                      "enum": [
                        "EQ"
                      ],
                      "type": "string"
                    },
                    "value": {
                      "description": "Can be any value, string, boolean, array, or object."
                    }
                  },
                  "title": "AuthnPolicyUserAttributeFilter",
                  "type": "object"
                },
                "type": "array"
              },
              "inclusions": {
                "items": {
                    "properties": {
                    "field": {
                      "description": "The only field that is currently supported is ldap_binding_user",
                      "type": "string"
                    },
                    "operator": {
                      "enum": [
                        "EQ"
                      ],
                      "type": "string"
                    },
                    "value": {
                      "description": "Can be any value, string, boolean, array, or object."
                    }
                  },
                  "title": "AuthnPolicyUserAttributeFilter",
                  "type": "object"
                },
                "type": "array"
              }
            },
            "title": "AuthnPolicyUserAttributeTarget",
            "type": "object"
        },
        "userGroups": {
            "properties": {
            "exclusions": {
              "items": {
                "type": "string"
              },
              "type": "array"
            },
            "inclusions": {
              "items": {
                "type": "string"
              },
              "type": "array"
            }
            },
            "title": "AuthnPolicyUserGroupTarget",
            "type": "object"
        },
        "users": {
            "properties": {
                "inclusions": {
                  "items": {
                    "type": "string"
                  },
                  "type": "array"
                }
              },
              "title": "AuthnPolicyUserTarget",
              "type": "object"
        }
      },
      "title": "AuthnPolicyTargets",
      "type": "object"
        },
        "type": {
          "default": "user_portal",
          "enum": [
            "user_portal",
            "application",
            "ldap"
          ],
          "title": "AuthnPolicyType",
          "type": "string"
        }
      },
  "$schema": "http://json-schema.org/draft-07/schema",
  "title": "AuthnPolicy",
  "type": "object"
}
